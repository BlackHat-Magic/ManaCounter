<!DOCTYPE html>
<html lang="en" x-data x-init="$store.theme.init()">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MTG Mana Counter</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='dist/main.css') }}"/>
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>

<body class="min-h-screen bg-background text-foreground" x-data="ManaCounter" x-init="init()">
<div
    x-data="parallaxPage({ intensity: 32, mobileIntensity: 10 })"
    x-init="init()"
    @mousemove="onMouseMove($event)"
    class="relative min-h-[100dvh] overflow-hidden"
>
<!-- BACKGROUND (z-0) -->
<div class="pointer-events-none fixed inset-0 z-0">
    <!-- Layer 1: soft blobs -->
    <div
        id="bg-layer-1"
        class="absolute inset-[-5%] will-change-transform"
        :style="layerStyle(1)"
    >
        <div class="h-full w-full bg-art-1"></div>
    </div>

    <!-- Layer 2: subtle grid/noise -->
    <div
        id="bg-layer-2"
        class="absolute inset-[-10%] will-change-transform mix-blend-overlay"
        :style="layerStyle(2)"
    >
        <div class="h-full w-full bg-art-2 opacity-70"></div>
    </div>

    <!-- Vignette -->
    <div
        class="absolute inset-0"
        aria-hidden="true"
        style="background: radial-gradient(80% 60% at 50% 40%, transparent 0%, transparent 55%, rgba(0,0,0,0.22) 70%, rgba(0,0,0,0.7) 100%);"
    ></div>
</div>

<div class="relative z-10">
<header
    class="mx-auto flex w-full items-center justify-between px-4 py-5"
>
<br/>

<div class="flex items-center gap-2">
    <!-- Ko-Fi -->
    <a
        href="https://ko-fi.com/lukethenderson"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex h-11 w-11 items-center justify-center rounded-md border border-border bg-card text-foreground shadow-sm transition-colors hover:bg-muted focus:outline-none"
        aria-label="Support on Ko-Fi"
        title="Ko-Fi"
    >
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" role="img" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
                <path d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"></path>
            </g>
        </svg>
    </a>

    <!-- GitHub button -->
    <a
        href="https://github.com/BlackHat-Magic/ManaCounter"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex h-11 w-11 items-center justify-center rounded-md border border-border bg-card text-foreground shadow-sm transition-colors hover:bg-muted focus:outline-none"
        aria-label="View GitHub repository"
        title="GitHub"
    >
        <svg
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            class="h-6 w-6"
        >
            <path
                d="M10 0c5.523 0 10 4.59 10 10.253 0 4.529-2.862 8.371-6.833 9.728-.507.101-.687-.219-.687-.492 0-.338.012-1.442.012-2.814 0-.956-.32-1.58-.679-1.898 2.227-.254 4.567-1.121 4.567-5.059 0-1.12-.388-2.034-1.03-2.752.102-.259.445-1.302-.1-2.714 0 0-.838-.275-2.747 1.051-.799-.227-1.655-.341-2.505-.345-.85.004-1.705.118-2.503.345-1.912-1.326-2.751-1.051-2.751-1.051-.543 1.412-.2 2.455-.096 2.714-.639.718-1.03 1.632-1.03 2.752 0 3.928 2.335 4.808 4.556 5.077-.286.256-.545.708-.635 1.371-.57.262-2.018.715-2.91-.852 0 0-.529-.985-1.533-1.057 0 0-.975-.013-.082.623 0 0 .655.315 1.11 1.5 0 0 .592 1.83 3.374 1.21.005.857.014 1.665.014 1.909 0 .271-.184.588-.683.493C2.862 18.624 0 14.782 0 10.253 0 4.59 4.477 0 10 0z"
            />
        </svg>
    </a>

    <!-- Theme control with selector -->
    <div x-data="ThemeUI" class="relative" @keydown.escape="close()" 
    x-cloak>
        <button
            @click="toggle()"
            @mouseover="open()"
            @mouseleave="close()"
            class="inline-flex h-11 w-11 items-center justify-center rounded-md border border-border bg-card text-accent shadow-sm transition-colors hover:bg-muted focus:outline-none"
            aria-label="Toggle light/dark theme"
            title="Toggle theme"
        >
            <svg x-show="$store.theme.mode === 'dark'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier">
                    <g clip-path="url(#clip0_429_11017)">
                        <path d="M20.9955 11.7115L22.2448 11.6721C22.2326 11.2847 22.0414 10.9249 21.7272 10.698C21.413 10.4711 21.0113 10.4029 20.6397 10.5132L20.9955 11.7115ZM12.2885 3.00454L13.4868 3.36028C13.5971 2.98873 13.5289 2.58703 13.302 2.2728C13.0751 1.95857 12.7153 1.76736 12.3279 1.75516L12.2885 3.00454ZM20.6397 10.5132C20.1216 10.667 19.5716 10.75 19 10.75V13.25C19.815 13.25 20.6046 13.1314 21.3512 12.9098L20.6397 10.5132ZM19 10.75C15.8244 10.75 13.25 8.17564 13.25 5H10.75C10.75 9.55635 14.4437 13.25 19 13.25V10.75ZM13.25 5C13.25 4.42841 13.333 3.87841 13.4868 3.36028L11.0902 2.64879C10.8686 3.39542 10.75 4.18496 10.75 5H13.25ZM12 4.25C12.0834 4.25 12.1665 4.25131 12.2492 4.25392L12.3279 1.75516C12.219 1.75173 12.1097 1.75 12 1.75V4.25ZM4.25 12C4.25 7.71979 7.71979 4.25 12 4.25V1.75C6.33908 1.75 1.75 6.33908 1.75 12H4.25ZM12 19.75C7.71979 19.75 4.25 16.2802 4.25 12H1.75C1.75 17.6609 6.33908 22.25 12 22.25V19.75ZM19.75 12C19.75 16.2802 16.2802 19.75 12 19.75V22.25C17.6609 22.25 22.25 17.6609 22.25 12H19.75ZM19.7461 11.7508C19.7487 11.8335 19.75 11.9166 19.75 12H22.25C22.25 11.8903 22.2483 11.781 22.2448 11.6721L19.7461 11.7508Z" fill="currentColor"></path>
                    </g>
                    <defs>
                        <clipPath id="clip0_429_11017">
                            <rect width="24" height="24" fill="currentColor"></rect>
                        </clipPath>
                    </defs>
                </g>
            </svg>
            <svg x-show="$store.theme.mode === 'light'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 64 64" fill="currentColor" stroke-width="2">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <g>
                        <circle fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" cx="32.003" cy="32.005" r="16.001"></circle>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M12.001,31.997c0-2.211-1.789-4-4-4H4c-2.211,0-4,1.789-4,4 s1.789,4,4,4h4C10.212,35.997,12.001,34.208,12.001,31.997z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M12.204,46.139l-2.832,2.833c-1.563,1.562-1.563,4.094,0,5.656 c1.562,1.562,4.094,1.562,5.657,0l2.833-2.832c1.562-1.562,1.562-4.095,0-5.657C16.298,44.576,13.767,44.576,12.204,46.139z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M32.003,51.999c-2.211,0-4,1.789-4,4V60c0,2.211,1.789,4,4,4 s4-1.789,4-4l-0.004-4.001C36.003,53.788,34.21,51.999,32.003,51.999z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M51.798,46.143c-1.559-1.566-4.091-1.566-5.653-0.004 s-1.562,4.095,0,5.657l2.829,2.828c1.562,1.57,4.094,1.562,5.656,0s1.566-4.09,0-5.656L51.798,46.143z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M60.006,27.997l-4.009,0.008 c-2.203-0.008-3.992,1.781-3.992,3.992c-0.008,2.211,1.789,4,3.992,4h4.001c2.219,0.008,4-1.789,4-4 C64.002,29.79,62.217,27.997,60.006,27.997z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M51.798,17.859l2.828-2.829c1.574-1.566,1.562-4.094,0-5.657 c-1.559-1.567-4.09-1.567-5.652-0.004l-2.829,2.836c-1.562,1.555-1.562,4.086,0,5.649C47.699,19.426,50.239,19.418,51.798,17.859z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M32.003,11.995c2.207,0.016,4-1.789,4-3.992v-4 c0-2.219-1.789-4-4-4c-2.211-0.008-4,1.781-4,3.993l0.008,4.008C28.003,10.206,29.792,11.995,32.003,11.995z"></path>
                        <path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M12.212,17.855c1.555,1.562,4.079,1.562,5.646-0.004 c1.574-1.551,1.566-4.09,0.008-5.649l-2.829-2.828c-1.57-1.571-4.094-1.559-5.657,0c-1.575,1.559-1.575,4.09-0.012,5.653 L12.212,17.855z"></path>
                    </g>
                </g>
            </svg>
        </button>

        <!-- Hovercard selector -->
        <div
            x-show="menuOpen"
            x-transition:enter="transition ease-out duration-100"
            x-transition:enter-start="opacity-0 scale-95"
            x-transition:enter-end="opacity-100 scale-100"
            x-transition:leave="transition ease-in duration-100"
            x-transition:leave-start="opacity-100 scale-100"
            x-transition:leave-end="opacity-0 scale-95"
            @mouseover="open()"
            @mouseleave="close()"
            class="absolute right-0 mt-2 w-80 rounded-md border border-border bg-card p-2 text-foreground shadow-md z-100"
        >
            <div class="flex items-center gap-1 p-1 border-b border-border">
                <button
                    @click="setTab('light')"
                    :class="activeTab === 'light' ? 'bg-muted text-foreground' : 'text-muted-foreground hover:bg-muted'"
                    class="px-3 py-1.5 text-sm rounded-md transition-colors"
                    role="tab"
                    aria-selected="activeTab === 'light'"
                >
                    Light
                </button>
                <button
                    @click="setTab('dark')"
                    :class="activeTab === 'dark' ? 'bg-muted text-foreground' : 'text-muted-foreground hover:bg-muted'"
                    class="px-3 py-1.5 text-sm rounded-md transition-colors"
                    role="tab"
                    aria-selected="activeTab === 'dark'"
                >
                    Dark
                </button>
            </div>

            <div class="px-1 py-2">
                <div x-show="activeTab === 'light'" role="tabpanel">
                    <div class="mb-1 text-xs font-semibold opacity-70">
                        Choose a light theme
                    </div>
                    <template x-for="t in $store.theme.lightThemes" :key="t.key">
                        <button
                            @click="$store.theme.setLight(t.key)"
                            class="w-full flex items-center justify-between text-left px-2 py-1.5 rounded hover:bg-muted"
                        >
                            <span x-text="t.name"></span>
                            <span
                                x-show="$store.theme.lightKey === t.key"
                                class="inline-flex h-2.5 w-2.5 rounded-full"
                                :style="`background: var(--accent);`"
                            ></span>
                        </button>
                    </template>
                </div>

                <div x-show="activeTab === 'dark'" role="tabpanel">
                    <div class="mb-1 text-xs font-semibold opacity-70">
                        Choose a dark theme
                    </div>
                    <template x-for="t in $store.theme.darkThemes" :key="t.key">
                        <button
                            @click="$store.theme.setDark(t.key)"
                            class="w-full flex items-center justify-between text-left px-2 py-1.5 rounded hover:bg-muted"
                        >
                            <span x-text="t.name"></span>
                            <span
                                x-show="$store.theme.darkKey === t.key"
                                class="inline-flex h-2.5 w-2.5 rounded-full"
                                :style="`background: var(--accent);`"
                            ></span>
                        </button>
                    </template>
                </div>
            </div>
        </div>
    </div>
</div>
</header>

<main
    class="mx-auto flex w-full flex-col items-center px-4"
>
<section
    class="md:mb-6 w-full rounded-lg p-5 text-center"
>
    <h2 class="inline-block md:block text-xl md:text-2xl font-semibold">Total Mana<span x-text="`: ${total()}`" class="md:hidden"></span></h2>
    <h2 class="hidden md:block mt-1 text-xl md:text-8xl font-black tabular-nums" x-text="total()"></h2>
    <button
        @click="reset()"
        class="inline-block ml-4 md:ml-0 mt-4 rounded-md bg-background px-6 py-3 font-medium transition-colors hover:bg-muted bg-card focus:outline-none"
    >
        Reset
    </button>
</section>

<section
    class="w-full p-5 mx-auto flex flex-wrap items-stretch justify-center gap-5"
>
    <template x-for="m in colors" :key="m.key">
        <div
            class="flex w-40 md:w-48 flex-col items-center justify-center p-3"
        >
            <button @click="inc(m.key)" class="inline-flex h-12 w-16 md:w-20 items-center justify-center rounded-md bg-card text-foreground shadow-sm transition-colors hover:bg-muted focus:outline-none" :aria-label="`Increment ${m.name}`" :title="`+1 ${m.name}`">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="18 15 12 9 6 15"></polyline>
                </svg>
            </button>

            <div class="relative">
                <div x-html="m.svg"></div>
                <div
                    class="absolute -right-[-10] -top-[-10] inline-flex w-12 h-12 items-center justify-center rounded-full bg-muted px-2 py-0.5 font-semibold leading-none shadow-sm text-3xl"
                    x-text="counts[m.key]"
                >
                    0
                </div>
            </div>

            <button
                @click="dec(m.key)"
                class="inline-flex h-12 w-16 md:w-20 items-center justify-center rounded-md bg-card text-foreground shadow-sm transition-colors hover:bg-muted focus:outline-none disabled:opacity-50"
                :disabled="counts[m.key] === 0"
                :aria-label="`Decrement ${m.name}`"
                :title="`-1 ${m.name}`"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-6 w-6"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>
        </div>
    </template>
</section>
</main>
</div>
</div>
</body>
</html>